<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <title>{{.title}}</title>
    <section class="hero is-info">
        <div class="hero-body">
            <p class="title">
                Info hero
            </p>
            <p class="subtitle">
                Info subtitle
            </p>
        </div>
    </section>
</head>
<body>
    <style>
    .div_chat{
        padding-left: 1rem;
    }

    .button-get-class {
        padding: 1rem;
    }
    </style>
    <div class="button-get-class">
    <div class="select is-info">
        <label>
            <select name="select_race" class="is-focused" >
                <option>-Select Race-</option>
                <option>Racist</option>
                <option>Elf</option>
                <option>Dwarf</option>
                <option>Orc</option>
                <option>Dragonborn</option>
            </select>
        </label>
    </div>
        <div class="select is-info">
            <label>
                <select name="select_class" class="is-focused">
                    <option>-Select Class-</option>
                    <option>Mage</option>
                    <option>Knight</option>
                    <option>Thief</option>
                    <option>Warrior</option>
                    <option>Lucky</option>
                </select>
            </label>
        </div>
        <div class="select is-info">
            <label>
                <select name="select_gender" class="is-focused">
                    <option>-Select Gender-</option>
                    <option>Man</option>
                    <option>Women</option>
                </select>
            </label>
        </div>
        <button class="button is-primary" id="btn_get_class" onclick="getCurrentClass()">Bulka</button>
    </div>
    <div class="tile is-ancestor">
        <div class="tile is-vertical">
            <div class="tile">
                <div class="tile is-parent is-vertical is-3 is-size-4-mobile">
                    <article class="tile is-child box">
                        <div class="div_chat" id="char_div" >
                            <p class="title"> Points</p>
                            <p> Class Name:  <label id="lbl_className_info"></label></p>
                            <p> Description:  <label id="lbl_description_info"></label></p>
                            <p> Strength: <label id="lbl_ability_strength_info"></label>  <label id="lbl_modifier_strength_info"></label></p>
                            <p> Dexterity: <label id="lbl_ability_dexterity_info"></label>  <label id="lbl_modifier_dexterity_info"></label></p>
                            <p> Body Difficulty: <label id="lbl_ability_bodyDifficulty_info"></label>  <label id="lbl_modifier_bodyDifficulty_info"></label></p>
                            <p> Intelligence: <label id="lbl_ability_intelligence_info"></label>  <label id="lbl_modifier_intelligence_info"></label></p>
                            <p> Wisdom: <label id="lbl_ability_wisdom_info"></label>  <label id="lbl_modifier_wisdom_info"></label></p>
                            <p> Charisma: <label id="lbl_ability_charisma_info"></label>  <label id="lbl_modifier_charisma_info"></label></p>
                        </div>
                    </article>
                    <article class="tile is-child box">
                        <p class="title">Saving Throws</p>
                        <p><label class="radio"><input type="radio" id="rd_modifier_ST_strength_info" disabled><label id="lbl_modifier_ST_strength_info"> </label> Strength</label></p>
                        <p><label class="radio"><input type="radio" id="rd_modifier_ST_dexterity_info" disabled><label id="lbl_modifier_ST_dexterity_info"> </label> Dexterity</label></p>
                        <p><label class="radio"><input type="radio" id="rd_modifier_ST_bodyDifficulty_info" disabled><label id="lbl_modifier_ST_bodyDifficulty_info"> </label> Body Difficulty</label></p>
                        <p><label class="radio"><input type="radio" id="rd_modifier_ST_intelligence_info" disabled><label id="lbl_modifier_ST_intelligence_info"> </label> Intelligence</label></p>
                        <p><label class="radio"><input type="radio" id="rd_modifier_ST_wisdom_info" disabled><label id="lbl_modifier_ST_wisdom_info"> </label> Wisdom</label></p>
                        <p><label class="radio"><input type="radio" id="rd_modifier_ST_charisma_info" disabled><label id="lbl_modifier_ST_charisma_info"> </label> Charisma</label></p>
                    </article>
                </div>
                <div class="tile is-parent is-vertical is-3 is-size-4-mobile">
                    <article class="tile is-child box">
                        <p><label class="title"><label> ( * ) </label> Inspiration</label> </p>
                    </article>
                    <article class="tile is-child box">
                        <p><label class="title"><label> (+2) </label> Proficiency Bonus</label> </p>
                    </article>
                </div>
            </div>
        </div>
    </div>

    <script>
        function selectClass(){
            var s = document.getElementsByName('select_class')[0];
            s.addEventListener("change", selectClass);
            return s.options[s.selectedIndex].value
        }

        function getCurrentClass() {
            const xhr = new XMLHttpRequest();
            xhr.open("GET", `${window.location.protocol}//${window.location.hostname}:${window.location.port}/api/v1/get-class`); //test-name
            xhr.onload = () => {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    let data = JSON.stringify(JSON.parse(xhr.response));
                    //console.log(data)
                    writeToAbilitiesLabels(data)
                    writeToSaveThrowsLabels(data)
                } else {
                    console.log(`Error: ${xhr.status}`);
                }
            };
            xhr.send();
        }

        function writeToAbilitiesLabels(data) {
            document.getElementById("lbl_className_info").innerHTML = JSON.parse(data)["class_name"];
            document.getElementById("lbl_description_info").innerHTML = JSON.parse(data)["description"];

            let abilities = JSON.stringify(JSON.parse(data)["ability"]);
            document.getElementById("lbl_ability_strength_info").innerHTML = JSON.parse(abilities)["strength"];
            document.getElementById("lbl_ability_dexterity_info").innerHTML = JSON.parse(abilities)["dexterity"];
            document.getElementById("lbl_ability_bodyDifficulty_info").innerHTML = JSON.parse(abilities)["body_difficulty"];
            document.getElementById("lbl_ability_intelligence_info").innerHTML = JSON.parse(abilities)["intelligence"];
            document.getElementById("lbl_ability_wisdom_info").innerHTML = JSON.parse(abilities)["wisdom"];
            document.getElementById("lbl_ability_charisma_info").innerHTML = JSON.parse(abilities)["charisma"];

            let modifier = JSON.stringify(JSON.parse(data)["modifier"]);
            document.getElementById("lbl_modifier_strength_info").innerHTML = "[ "+JSON.parse(modifier)["strength"]+" ]";
            document.getElementById("lbl_modifier_dexterity_info").innerHTML = "[ "+ JSON.parse(modifier)["dexterity"]+" ]";
            document.getElementById("lbl_modifier_bodyDifficulty_info").innerHTML = "[ "+JSON.parse(modifier)["body_difficulty"]+" ]";
            document.getElementById("lbl_modifier_intelligence_info").innerHTML = "[ "+ JSON.parse(modifier)["intelligence"]+" ]";
            document.getElementById("lbl_modifier_wisdom_info").innerHTML = "[ "+JSON.parse(modifier)["wisdom"]+" ]";
            document.getElementById("lbl_modifier_charisma_info").innerHTML = "[ "+JSON.parse(modifier)["charisma"]+" ]";
        }

        function writeToSaveThrowsLabels(data) {
            let saving_throws = JSON.stringify(JSON.parse(data)["saving_throws"]);
            console.log(saving_throws)

            //обнуление радио
            document.getElementById("rd_modifier_ST_strength_info").checked=false;
            document.getElementById("rd_modifier_ST_dexterity_info").checked=false;
            document.getElementById("rd_modifier_ST_bodyDifficulty_info").checked=false;
            document.getElementById("rd_modifier_ST_intelligence_info").checked=false;
            document.getElementById("rd_modifier_ST_wisdom_info").checked=false;
            document.getElementById("rd_modifier_ST_charisma_info").checked=false;


            document.getElementById("lbl_modifier_ST_strength_info").innerHTML = "[ "+JSON.parse(saving_throws)["strength"]["point"]+" ]";
            document.getElementById("lbl_modifier_ST_dexterity_info").innerHTML = "[ "+ JSON.parse(saving_throws)["dexterity"]["point"]+" ]";
            document.getElementById("lbl_modifier_ST_bodyDifficulty_info").innerHTML = "[ "+JSON.parse(saving_throws)["body_difficulty"]["point"]+" ]";
            document.getElementById("lbl_modifier_ST_intelligence_info").innerHTML = "[ "+ JSON.parse(saving_throws)["intelligence"]["point"]+" ]";
            document.getElementById("lbl_modifier_ST_wisdom_info").innerHTML = "[ "+JSON.parse(saving_throws)["wisdom"]["point"]+" ]";
            document.getElementById("lbl_modifier_ST_charisma_info").innerHTML = "[ "+JSON.parse(saving_throws)["charisma"]["point"]+" ]";

            if (JSON.parse(saving_throws)["strength"]["mastery"] === true){
                document.getElementById("rd_modifier_ST_strength_info").checked=true;
            }
            if (JSON.parse(saving_throws)["dexterity"]["mastery"] === true){
                document.getElementById("rd_modifier_ST_dexterity_info").checked=true;
            }
            if (JSON.parse(saving_throws)["body_difficulty"]["mastery"]=== true){
                document.getElementById("rd_modifier_ST_bodyDifficulty_info").checked=true;
            }
            if (JSON.parse(saving_throws)["intelligence"]["mastery"]=== true){
                document.getElementById("rd_modifier_ST_intelligence_info").checked=true;
            }
            if (JSON.parse(saving_throws)["wisdom"]["mastery"]=== true){
                document.getElementById("rd_modifier_ST_wisdom_info").checked=true;
            }
            if (JSON.parse(saving_throws)["charisma"]["mastery"]=== true){
                document.getElementById("rd_modifier_ST_charisma_info").checked=true;
            }
        }




    </script>
</body>
</html>